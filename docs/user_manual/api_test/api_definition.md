接口定义，主要用于接口的详情说明，包含接口路径说明、请求体说明、响应体说明等，支持HTTP协议、TCP协议、SQL、DUBBO等。

## 模块树管理
每个接口都需要属于一个特定的模块，在创建接口前需要先规划并创建模块树。

### 切换协议
在模块树左上方的协议切换下拉框中，可以选择支持的协议进行切换，展示该项目下不同协议的接口列表。

!!! info "说明"
    不同协议间模块树相互独立，当切换协议后需要重新创建模块树。

### 创建一级模块
![!创建一级模块](../../img/api/创建一级模块.png)

!!! info "说明"
    模块树支持最多 8 层的树状结构。

### 模块操作
![!模块操作](../../img/api/模块操作.png)

!!! info "操作说明"
    1. `重命名` 按钮，鼠标悬停在要操作的模块时出现，点击可以重命名该模块。
    2. `添加子模块` 按钮，鼠标悬停在要操作的模块时出现，点击可以在该模块下添加子模块。
    3. `删除` 按钮，鼠标悬停在要操作的模块时出现，点击将删除该模块和其所有子模块。
    4. `展开/收起` 操作，当模块下存在子模块时出现，点击将展开/收起该模块下的所有子模块。

!!! error "注意"
    删除某个模块不仅会删除该模块及其所有子模块，被删除模块中的接口及接口用例也将被移入回收站中，请谨慎使用该功能。

模块树还支持鼠标拖拽操作，用户可以根据需求调整模块顺序及其层级关系。
![!模块拖拽](../../img/api/模块拖拽.gif)

## 接口管理

### 接口快捷调试 
在定义接口前，如果对接口的请求参数和响应参数具体内容不清晰，可以使用快捷调试方式，对接口进行快速调试，调试过程中也支持前后置脚本与提取断言等方式。调试完成后，可以直接保存为新接口并在该接口下使用填入的参数自动创建一个用例。
![!接口快捷调试](../../img/api/接口快捷调试.gif)

### 快速创建接口
在模块树中选择模块，点击模块树上方搜索框右侧的 `创建接口` 按钮，可以仅填写接口基本信息，在该模块下快速创建接口。
![!快速创建接口](../../img/api/快速创建接口.gif)

### 编辑接口详情
在接口列表中点击指定接口操作列中的 `编辑` 按钮，进入接口详情编辑页面。在该页面中可以对接口的基础信息、请求及响应定义进行进一步编辑。
![!编辑接口详情](../../img/api/编辑接口详情.gif)

!!! info "说明"
    不同协议的接口详情说明请参考 [TBD](TBD)。

### 导入接口定义
MeterSphere 支持从已有文件中导入接口定义，目前支持的文件格式有 `MeterSphere` 导出文件，`Postman` 文件，`Swagger` 文件。
![!导入Swagger文件](../../img/api/导入swagger文件.gif)

![!接口导入](../../img/api/接口导入.png)

!!! info "参数说明"
    1. **数据格式**：选择要导入的文件的格式。
    2. **导入模块**：要导入的文件的基准模块，默认为根模块。如果选择了某个模块，则导入时将在该模块下创建子模块。
    3. **导入模式**：支持 `全量覆盖` 与 `增量合并` 两种模式，默认为 `全量覆盖`。当选择 `全量覆盖` 时，会将已存在的相同 URL 的接口进行覆盖；当选择 `增量合并` 时，只会导入当前不存在的接口。
    4. 文件上传区域，将文件拖到此处或点击 `点击上传` 进行上传。

针对 Swagger 格式的接口文档，还提供了通过 URL 导入及定时同步功能。
![!Swagger接口导入](../../img/api/Swagger接口导入.png)

!!! info "参数说明"
    1. 是否使用 URL 导入，开启后需要填入 Swagger 文档的 URL，否则需要上传 Swagger 文件。
    2. Swagger URL，Swagger 文档的 URL 地址，例如 `https://petstore.swagger.io/v2/swagger.json`。
    3. 是否开启定时同步，开启后弹出定时任务配置页面，配置定时任务后系统将在指定时间按照选择的导入模式及导入模块，自动从该 URL 更新接口定义。


!!! info "说明"
    不同协议的接口详情说明请参考 [TBD](TBD)。

### 针对单个接口发起测试
在接口列表中点击指定接口操作列中的 `编辑` 按钮，进入接口详情编辑页面。点击页面右上方的 `测试` 按钮，进入单个接口测试页面。

在该页面中系统将自动加载接口定义中已定义的 URL、参数等信息，选择接口执行环境，并根据接口定义填入实际参数值后，点击 `测试` 按钮。
![!针对单个接口发起测试](../../img/api/针对单个接口发起测试.gif)

同时在测试过程中也可以点击右侧按钮，添加前后置脚本、断言及变量提取等子步骤。

!!! info "说明"
    前后置脚本、断言及变量提取等子步骤的详情说明请参考 [用例步骤说明](./api_step.md#_1)。

除此之外，在单个接口的测试页面还提供了各种快捷操作。
![!接口测试页面更多操作](../../img/api/接口测试页面更多操作.png)

!!! info "操作说明"
    1. `加载用例`：选择并加载该接口下的一个已有用例。
    2. `另存为新用例`：使用当前页面填写的参数及添加的子步骤在该接口下创建一个新用例。
    3. `更新接口`：使用当前页面填写的参数更新该接口的接口定义。
    4. `另存为新接口`：使用当前页面填写的参数创建一个新的接口。

### 将接口移入回收站
在接口列表中点击指定接口操作列中的 `删除` 按钮，接口及接口下的用例将被移入回收站，同时接口变为 `废弃` 状态。用户可以点击左侧模块树中的 `回收站` 查看已废弃的接口。
![!删除接口](../../img/api/删除接口.gif)

### 恢复接口
点击左侧模块树中的 `回收站`，选择要恢复的接口点击操作列中的 `恢复` 按钮。
![!恢复接口](../../img/api/恢复接口.gif)

### 彻底删除接口
点击左侧模块树中的 `回收站`，选择要彻底删除的接口点击操作列中的 `删除` 按钮。
![!彻底删除接口](../../img/api/彻底删除接口.gif)

!!! error "注意"
    从回收站中删除某个接口时，该接口及接口下的用例将从数据库中删除且无法恢复，请谨慎使用该功能。

## 接口用例管理

### 查看指定接口下的用例
在接口列表中点击指定接口操作列中的 `用例列表` 按钮，弹出该接口下的用例列表页面。
![!单个接口下用例列表](../../img/api/单个接口下用例列表.gif)

### 查看指定模块下的用例
点击接口列表上方且列表切换按钮中的 `用例列表` 按钮，将当前列表切换为接口用例列表。
![!接口用例列表](../../img/api/接口用例列表.png)

### 新建接口用例
在单个接口用例列表中点击 `添加用例` 按钮，输入用例的名称、标签及参数详情后，点击保存按钮完成用例创建。

同时接口用例中也可以点击右侧按钮，添加前后置脚本、断言及变量提取等子步骤。
![!新建接口用例](../../img/api/新建接口用例.gif)

!!! info "说明"
    前后置脚本、断言及变量提取等子步骤的详情说明请参考 [用例步骤说明](./api_step.md#_1)。

### 执行接口用例
接口用例创建完成后，选择用例执行环境并点击 `执行` 按钮，用例执行完成后可点击查看 `执行结果`。
![!执行接口用例](../../img/api/执行接口用例.gif)

### 批量执行接口用例
在单个接口用例列表中选择用例执行环境，选中多个接口后点击批量操作按钮中的 `批量执行`，所有用例执行完成后可点击指定用例查看 `执行结果`。
![!批量执行接口用例](../../img/api/批量执行接口用例.gif)

### 删除接口用例
在单个接口用例列表中点击 `删除` 按钮，弹出的确认对话框中再次点击确定后即可删除该用例。
![!删除接口用例](../../img/api/删除接口用例.gif)

!!! error "注意"
    删除某个接口用例时，该接口用例将从数据库中删除且无法恢复，请谨慎使用该功能。